import pandas as pd
import os

"""
    这段代码可以适用于将类似“信息项---年份”格式的数据
    自动提取为矩阵形式并导出为CSV文件
    它会将信息项作为行、年份作为列,填入指定的标记符号
    用于清晰展示各信息项在不同年份的分布情况。
"""

data_list = ['LBXSAL - Albumin (g/dL)---1999-2000', 'LBDSALSI - Albumin (g/L)---1999-2000', 'LBXSGL - Glucose (mg/dL)---1999-2000', 'LBDSGLSI - Glucose (mmol/L)---1999-2000', 'LBXSTR - Triglycerides (mg/dL)---1999-2000', 'LBDSTRSI - Triglycerides (mmol/L)---1999-2000', 'LBXSCR - Creatinine (mg/dL)---1999-2000', 'LBDSCRSI - Creatinine (umol/L)---1999-2000', 'LBXSNASI - Sodium (mmol/L)---1999-2000', 'LBXSKSI - Potassium (mmol/L)---1999-2000', 'LBXHGB - Hemoglobin (g/dL)---1999-2000', 'SSGALB - Glycated Albumin g/dL---1999-2000', 'SSGALBL - Glycated Albumin comment code---1999-2000', 'SSALB - Albumin g/dL---1999-2000', 'SSALBL - Albumin comment code---1999-2000', 'SSALB - Albumin---1999-2000', 'LB2HGB   - Hemoglobin (g/dL)---2001-2002', 'LBXHGB - Hemoglobin (g/dL)---2001-2002', 'LB2SAL - Albumin (g/dL)---2001-2002', 'LB2SALSI - Albumin (g/L)---2001-2002', 'LB2SCH - Cholesterol (mg/dL)---2001-2002', 'LB2SCHSI - Cholesterol (mmol/L)---2001-2002', 'LB2SGL - Glucose (mg/dL)---2001-2002', 'LB2STR - Triglycerides (mg/dL)---2001-2002', 'LB2STRSI - Triglycerides (mmol/L)---2001-2002', 'LB2SCR - Creatinine (mg/dL)---2001-2002', 'LB2SCRSI - Creatinine (umol/L)---2001-2002', 'LB2SNASI - Sodium (mmol/L)---2001-2002', 'LB2SKSI - Potassium (mmol/L)---2001-2002', 'LBXSAL - Albumin (g/dL)---2001-2002', 'LBDSALSI - Albumin (g/L)---2001-2002', 'LBXSCH - Cholesterol (mg/dL)---2001-2002', 'LBDSCHSI - Cholesterol (mmol/L)---2001-2002', 'LBXSTR - Triglycerides (mg/dL)---2001-2002', 'LBDSTRSI - Triglycerides (mmol/L)---2001-2002', 'LBDSCR - Creatinine (mg/dL)---2001-2002', 'LBDSCRSI - Creatinine (umol/L)---2001-2002', 'SSGALB - Glycated Albumin g/dL---2001-2002', 'SSGALBL - Glycated Albumin comment code---2001-2002', 'SSALB - Albumin g/dL---2001-2002', 'SSALBL - Albumin comment code---2001-2002', 'SSALB - Albumin---2001-2002', 'LBXTC - Total Cholesterol (mg/dL)---2003-2004', 'LBDTCSI - Total Cholesterol (mmol/L)---2003-2004', 'LBXHGB - Hemoglobin (g/dL)---2003-2004', 'LBXSAL - Albumin (g/dL)---2003-2004', 'LBDSALSI - Albumin (g/L)---2003-2004', 'LBXSATSI - Alanine aminotransferase ALT (U/L)---2003-2004', 'LBXSASSI - Aspartate aminotransferase AST (U/L)---2003-2004', 'LBXSCH - Cholesterol (mg/dL)---2003-2004', 'LBDSCHSI - Cholesterol (mmol/L)---2003-2004', 'LBXSTR - Triglycerides (mg/dL)---2003-2004', 'LBDSTRSI - Triglycerides (mmol/L)---2003-2004', 'LBXSCR - Creatinine (mg/dL)---2003-2004', 'LBDSCRSI - Creatinine (umol/L)---2003-2004', 'LBXSNASI - Sodium (mmol/L)---2003-2004', 'LBXSKSI - Potassium (mmol/L)---2003-2004', 'SSGALB - Glycated Albumin g/dL---2003-2004', 'SSGALBL - Glycated Albumin comment code---2003-2004', 'SSALB - Albumin g/dL---2003-2004', 'SSALBL - Albumin comment code---2003-2004', 'SSALB - Albumin---2003-2004', 'LBXSAL - Albumin (g/dL)---2005-2006', 'LBDSALSI - Albumin (g/L)---2005-2006', 'LBXSATSI - Alanine aminotransferase ALT (U/L)---2005-2006', 'LBXSASSI - Aspartate aminotransferase AST (U/L)---2005-2006', 'LBXSCH - Cholesterol (mg/dL)---2005-2006', 'LBDSCHSI - Cholesterol (mmol/L)---2005-2006', 'LBXSCR - Creatinine (mg/dL)---2005-2006', 'LBDSCRSI - Creatinine (umol/L)---2005-2006', 'LBXSTR - Triglycerides (mg/dL)---2005-2006', 'LBDSTRSI - Triglycerides (mmol/L)---2005-2006', 'LBXSNASI - Sodium (mmol/L)---2005-2006', 'LBXSKSI - Potassium (mmol/L)---2005-2006', 'LBXHGB - Hemoglobin (g/dL)---2005-2006', 'LBXGLU - Fasting Glucose (mg/dL)---2005-2006', 'LBDGLUSI - Fasting Glucose (mmol/L)---2005-2006', 'LBXAPB - Apolipoprotein (B) (mg/dL)---2005-2006', 'LBDAPBSI - Apolipoprotein (B) (g/L)---2005-2006', 'LBXAPB - Apolipoprotein (B) (mg/dL)---2007-2008', 'LBDAPBSI - Apolipoprotein (B) (g/L)---2007-2008', 'LBXSAL - Albumin (g/dL)---2007-2008', 'LBDSALSI - Albumin (g/L)---2007-2008', 'LBXSATSI - Alanine aminotransferase (ALT) (U/L)---2007-2008', 'LBXSCH - Cholesterol (mg/dL) ---2007-2008', 'LBDSCHSI - Cholesterol (mmol/L)---2007-2008', 'LBXSCR - Creatinine (mg/dL)---2007-2008', 'LBDSCRSI - Creatinine (µmol/L)---2007-2008', 'LBXSTR - Triglycerides (mg/dL) ---2007-2008', 'LBDSTRSI - Triglycerides (mmol/L)---2007-2008', 'LBXSNASI - Sodium (mmol/L)---2007-2008', 'LBXSKSI - Potassium (mmol/L)---2007-2008', 'LBXHGB - Hemoglobin (g/dL)---2007-2008', 'URXUCR - Urinary Creatinine (mg/dL)---2007-2008', 'LBXGLU - Fasting Glucose (mg/dL)---2007-2008', 'LBDGLUSI - Fasting Glucose (mmol/L)---2007-2008', 'GTDSCMMN - Glucose challenge Administer Time inmin---2007-2008', 'SSUSG - Urine specific gravity---2007-2008', 'LBXTC - Total Cholesterol (mg/dL)---2007-2008', 'LBXAPB   - Apolipoprotein (B) (mg/dL)---2009-2010', 'LBDAPBSI - Apolipoprotein (B) (g/L)---2009-2010', 'LBXSAL - Albumin (g/dL)---2009-2010', 'LBDSALSI - Albumin (g/L)---2009-2010', 'LBXSATSI - Alanine aminotransferase ALT (U/L)---2009-2010', 'LBXSASSI - Aspartate aminotransferase AST (U/L)---2009-2010', 'LBXSCH - Cholesterol (mg/dL)---2009-2010', 'LBDSCHSI - Cholesterol (mmol/L)---2009-2010', 'LBXSCR - Creatinine (mg/dL)---2009-2010', 'LBDSCRSI - Creatinine (umol/L)---2009-2010', 'LBXSTR - Triglycerides (mg/dL)---2009-2010', 'LBDSTRSI - Triglycerides (mmol/L)---2009-2010', 'LBXSNASI - Sodium (mmol/L)---2009-2010', 'LBXSKSI - Potassium (mmol/L)---2009-2010', 'LBXHGB - Hemoglobin (g/dL)---2009-2010', 'URXUCR   - Urinary Creatinine (mg/dL)---2009-2010', 'LBXGLU   - Fasting Glucose (mg/dL)---2009-2010', 'LBDGLUSI - Fasting Glucose (mmol/L)---2009-2010', 'GTDSCMMN - Glucose challenge Administer Time inmin---2009-2010', 'LBXTC - Total Cholesterol (mg/dL)---2009-2010', 'LBDTCSI - Total Cholesterol (mmol/L)---2009-2010', 'URDFLOW1 - Urine #1 Flow Rate (mL/min)---2009-2010', 'URDFLOW2 - Urine #2 Flow Rate (mL/min)---2009-2010', 'URDFLOW3 - Urine #3 Flow Rate (mL/min)---2009-2010', 'URXOAV - Urine osmolality (mOsm/kg)---2009-2010', 'URDACT   - Albumin creatinine ratio (mg/g)---2011-2012', 'LBXAPB - Apolipoprotein (B) (mg/dL)---2011-2012', 'LBDAPBSI - Apolipoprotein (B) (g/L)---2011-2012', 'LBXSAL - Albumin (g/dL)---2011-2012', 'LBDSALSI - Albumin (g/L)---2011-2012', 'LBXSATSI - Alanine aminotransferase ALT (U/L)---2011-2012', 'LBXSASSI - Aspartate aminotransferase AST (U/L)---2011-2012', 'LBXSCH - Cholesterol (mg/dL)---2011-2012', 'LBDSCHSI - Cholesterol (mmol/L)---2011-2012', 'LBXSCR - Creatinine (mg/dL)---2011-2012', 'LBDSCRSI - Creatinine (umol/L)---2011-2012', 'LBXSNASI - Sodium (mmol/L)---2011-2012', 'LBXSKSI - Potassium (mmol/L)---2011-2012', 'LBXSTR - Triglycerides (mg/dL)---2011-2012', 'LBDSTRSI - Triglycerides (mmol/L)---2011-2012', 'LBXHGB   - Hemoglobin (g/dL)---2011-2012', 'URXUCR   - Urinary Creatinine (mg/dL)---2011-2012', 'LBXGLU - Fasting Glucose (mg/dL)---2011-2012', 'LBDGLUSI - Fasting Glucose (mmol/L)---2011-2012', 'GTDSCMMN - Glucose challenge Administer Time in min---2011-2012', 'URDFLOW1 - Urine #1 Flow Rate (mL/min)---2011-2012', 'URDFLOW2 - Urine #2 Flow Rate (mL/min)---2011-2012', 'URDFLOW3 - Urine #3 Flow Rate (mL/min)---2011-2012', 'URXOAV - Urine osmolality (mOsm/kg)---2011-2012', 'URDACT - Albumin creatinine ratio (mg/g)---2013-2014', 'LBXAPB - Apolipoprotein (B) (mg/dL)---2013-2014', 'LBDAPBSI - Apolipoprotein (B) (g/L)---2013-2014', 'LBXSAL - Albumin (g/dL)---2013-2014', 'LBDSALSI - Albumin (g/L)---2013-2014', 'LBXSASSI - Aspartate aminotransferase AST (IU/L)---2013-2014', 'LBXSATSI - Alanine aminotransferase ALT (IU/L)---2013-2014', 'LBXSCH - Cholesterol (mg/dL)---2013-2014', 'LBDSCHSI - Cholesterol (mmol/L)---2013-2014', 'LBXSCR - Creatinine (mg/dL)---2013-2014', 'LBDSCRSI - Creatinine (umol/L)---2013-2014', 'LBXSKSI - Potassium (mmol/L)---2013-2014', 'LBXSNASI - Sodium (mmol/L)---2013-2014', 'LBXHGB   - Hemoglobin (g/dL)---2013-2014', 'LBXGLU - Fasting Glucose (mg/dL)---2013-2014', 'LBDGLUSI - Fasting Glucose (mmol/L)---2013-2014', 'GTDSCMMN - Glucose challenge Administer Time in min---2013-2014', 'URXUCR - Urinary Creatinine---2013-2014', 'URDFLOW1 - Urine #1 Flow Rate (mL/min)---2013-2014', 'URDFLOW2 - Urine #2 Flow Rate (mL/min)---2013-2014', 'URDFLOW3 - Urine #3 Flow Rate (mL/min)---2013-2014', 'URDACT - Albumin creatinine ratio (mg/g)---2015-2016', 'LBXAPB - Apolipoprotein (B) (mg/dL)---2015-2016', 'LBDAPBSI - Apolipoprotein (B) (g/L)---2015-2016', 'LBXSASSI - Aspartate Aminotransferase (AST) (IU/L)---2015-2016', 'LBXSATSI - Alanine Aminotransferase (ALT) (IU/L)---2015-2016', 'LBXSBU - Blood Urea Nitrogen (mg/dL)---2015-2016', 'LBDSBUSI - Blood Urea Nitrogen (mmol/L)---2015-2016', 'LBXSKSI - Potassium (mmol/L)---2015-2016', 'LBXSNASI - Sodium (mmol/L)---2015-2016', 'LBXSTB - Total Bilirubin (mg/dL)---2015-2016', 'LBDSTBSI - Total Bilirubin (umol/L)---2015-2016', 'LBXSTP - Total Protein (g/dL)---2015-2016', 'LBDSTPSI - Total Protein (g/L)---2015-2016', 'LBXHGB - Hemoglobin (g/dL)---2015-2016', 'URXUCL- Chlamydia, Urine---2015-2016', 'LBXGLU - Fasting Glucose (mg/dL)---2015-2016', 'LBDGLUSI - Fasting Glucose (mmol/L)---2015-2016', 'LBXHSCRP - HS C-Reactive Protein (mg/L)---2015-2016', 'LBDHRPLC - HS C-Reactive Protein Comment Code---2015-2016', 'LBXGLT - Two Hour Glucose (OGTT) (mg/dL)---2015-2016', 'LBDGLTSI - Two Hour Glucose (OGTT) (mmol/L)---2015-2016', 'GTDSCMMN - Glucose challenge Administer Time inmin---2015-2016', 'LBXTC    - Total Cholesterol (mg/dL)---2015-2016', 'LBDTCSI - Total Cholesterol (mmol/L)---2015-2016', 'URXUTRI - Trichomonas, Urine---2015-2016', 'URDFLOW1 - Urine #1 Flow Rate (mL/min)---2015-2016', 'URDFLOW2 - Urine #2 Flow Rate (mL/min)---2015-2016', 'URDFLOW3 - Urine #3 Flow Rate (mL/min)---2015-2016', 'URXPREG  - Urine Pregnancy Result---2015-2016', 'URXUHG - Urine Mercury (ng/mL)---2015-2016', 'URDUHGLC - Mercury, Urine Comment Code---2015-2016', 'URDACT - Albumin creatinine ratio (mg/g)---2017-2018', 'LBXSATSI - Alanine Aminotransferase (ALT) (IU/L)---2017-2018', 'LBXSASSI - Aspartate Aminotransferase (AST)(IU/L)---2017-2018', 'LBXSBU - Blood Urea Nitrogen (mg/dL)---2017-2018', 'LBDSBUSI - Blood Urea Nitrogen (mmol/L)---2017-2018', 'LBXSKSI - Potassium (mmol/L)---2017-2018', 'LBXSNASI - Sodium (mmol/L)---2017-2018', 'LBXSTB - Total Bilirubin (mg/dL)---2017-2018', 'LBDSTBSI - Total Bilirubin (umol/L)---2017-2018', 'LBDSTBLC - Total Bilirubin Comment Code---2017-2018', 'LBXSTP - Total Protein (g/dL)---2017-2018', 'LBDSTPSI - Total Protein (g/L)---2017-2018', 'LBXHGB- Hemoglobin (g/dL)---2017-2018', 'URXBCPP - Bis (1-chloro-2-propyl) Phosphate---2017-2018', 'URDBCPLC - Bis (1-chloro-2-propyl) Phosphate Comt---2017-2018', 'URXBCEP - Bis-2-chloroethyl Phosphate---2017-2018', 'URDCEPLC - Bis-2-chloroethyl Phosphate Comt Code---2017-2018', 'URXBDCP - Bis (1,3-dichloro-2-propyl) Phosphate---2017-2018', 'URXDBUP - Dibutyl Phosphate---2017-2018', 'URDDUPLC - Dibutyl Phosphate Comment Code---2017-2018', 'URXDPHP - Diphenyl Phosphate---2017-2018', 'URDDPHLC - Diphenyl Phosphate Comment Code---2017-2018', 'LBXGLU - Fasting Glucose (mg/dL)---2017-2018', 'LBDGLUSI - Fasting Glucose (mmol/L)---2017-2018', 'LBXHSCRP - HS C-Reactive Protein (mg/L)---2017-2018', 'LBDHRPLC - HS C-Reactive Protein Comment Code---2017-2018', 'LBXTC - Total Cholesterol (mg/dL)---2017-2018', 'LBDTCSI - Total Cholesterol (mmol/L)---2017-2018', 'URDFLOW1 - Urine #1 Flow Rate (mL/min)---2017-2018', 'URDFLOW2 - Urine #2 Flow Rate (mL/min)---2017-2018', 'URDFLOW3 - Urine #3 Flow Rate (mL/min)---2017-2018', 'URXUCM - Chromium, Urine (ug/L)---2017-2018', 'URDUCMLC - Chromium, Urine Comment Code---2017-2018', 'URXPREG - Urine Pregnancy Result---2017-2018', 'URXUHG - Urine Mercury (ug/L)---2017-2018', 'URDUHGLC - Mercury, Urine Comment Code---2017-2018', 'URXUNI - Nickel, Urine (ug/L)---2017-2018', 'URDUNILC - Nickel, Urine Comment Code---2017-2018', 'URXUAS - Arsenic, Total - Urine (ug/L)---2017-2018', 'URDUASLC - Arsenic, Total - Urine Comment Code---2017-2018', 'URDACT - Albumin creatinine ratio (mg/g)---2019-2020', 'LBXSATSI - Alanine Aminotransferase (ALT) (IU/L)---2019-2020', 'LBXSASSI - Aspartate Aminotransferase (AST) (IU/L)---2019-2020', 'LBXSBU - Blood Urea Nitrogen (mg/dL)---2019-2020', 'LBDSBUSI - Blood Urea Nitrogen (mmol/L)---2019-2020', 'LBXSKSI - Potassium (mmol/L)---2019-2020', 'LBXSNASI - Sodium (mmol/L)---2019-2020', 'LBXSTB - Total Bilirubin (mg/dL)---2019-2020', 'LBDSTBSI - Total Bilirubin (umol/L)---2019-2020', 'LBDSTBLC - Total Bilirubin Comment Code---2019-2020', 'LBXSTP - Total Protein (g/dL)---2019-2020', 'LBDSTPSI - Total Protein (g/L)---2019-2020', 'LBXHGB - Hemoglobin (g/dL)---2019-2020', 'URXBCPP - Bis (1-chloro-2-propyl) Phosphate---2019-2020', 'URDBCPLC - Bis (1-chloro-2-propyl) Phosphate Comt---2019-2020', 'URXBCEP - Bis-2-chloroethyl Phosphate---2019-2020', 'URDCEPLC - Bis-2-chloroethyl Phosphate Comt Code---2019-2020', 'URXBDCP - Bis (1,3-dichloro-2-propyl) Phosphate---2019-2020', 'URXDBUP - Dibutyl Phosphate---2019-2020', 'URDDUPLC - Dibutyl Phosphate Comment Code---2019-2020', 'URXDPHP - Diphenyl Phosphate---2019-2020', 'URDDPHLC - Diphenyl Phosphate Comment Code---2019-2020', 'LBXGLU- Fasting Glucose (mg/dL)---2019-2020', 'LBDGLUSI- Fasting Glucose (mmol/L)---2019-2020', 'LBXHSCRP - HS C-Reactive Protein (mg/L)---2019-2020', 'LBDHRPLC - HS C-Reactive Protein Comment Code---2019-2020', 'LBXTC - Total Cholesterol (mg/dL)---2019-2020', 'LBDTCSI - Total Cholesterol (mmol/L)---2019-2020', 'URDFLOW1 - Urine #1 Flow Rate (mL/min)---2019-2020', 'URDFLOW2 - Urine #2 Flow Rate (mL/min)---2019-2020', 'URDFLOW3 - Urine #3 Flow Rate (mL/min)---2019-2020', 'URXUCM - Chromium, Urine (ug/L)---2019-2020', 'URDUCMLC - Chromium, Urine Comment Code---2019-2020', 'URXPREG - Urine Pregnancy Result---2019-2020', 'URXUHG - Urine Mercury (ug/L)---2019-2020', 'URDUHGLC - Mercury, Urine Comment Code---2019-2020', 'URXUNI - Nickel, Urine (ug/L)---2019-2020', 'URDUNILC - Nickel, Urine Comment Code---2019-2020', 'URXUAS - Arsenic, Total - Urine (ug/L)---2019-2020', 'URDUASLC - Arsenic, Total - Urine Comment Code---2019-2020']


filename = "Test"
# 创建一个字典来存储信息项和年份
data_dict = {}
# 提取信息项和年份，构建字典
for item in data_list:
    info, year = item.split('---')
    info = info.strip()
    year = year.strip()
    if info not in data_dict:
        data_dict[info] = {}
    data_dict[info][year] = "*"

# 创建DataFrame并填充数据
df = pd.DataFrame(data_dict).T  # 转置后以信息项为行，年份为列

# 将结果写入CSV文件
output_path = os.path.join(filename + '.csv')
df.to_csv(output_path, index=True, encoding='utf-8')
print(f"数据已成功写入{output_path}文件.")